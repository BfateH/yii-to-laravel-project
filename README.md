# üöÄ –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞

–î–ª—è —É—Å–ø–µ—à–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:

## üìã –ö–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–π —Å–ø–∏—Å–æ–∫ —É—Å—Ç–∞–Ω–æ–≤–∫–∏

| –°—Ç–∞—Ç—É—Å | –ó–∞–¥–∞—á–∞                         | –ö–æ–º–∞–Ω–¥–∞ / –î–µ–π—Å—Ç–≤–∏–µ                |
|:------:|--------------------------------|-----------------------------------|
|   ‚úÖ    | –£—Å—Ç–∞–Ω–æ–≤–∫–∞ PHP-–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π     | `composer install`                |
|   ‚úÖ    | –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è            | –ù–∞—Å—Ç—Ä–æ–∏—Ç—å `.env`                  |
|   ‚úÖ    | –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª—é—á–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è     | `php artisan key:generate`        |
|   ‚úÖ    | –ì–µ–Ω–µ—Ä–∞—Ü–∏—è JWT —Å–µ–∫—Ä–µ—Ç–∞          | `php artisan jwt:secret`          |
|   ‚úÖ    | –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Node.js –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π | `npm install`                     |
|   ‚úÖ    | –°–±–æ—Ä–∫–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞               | `npm run build`                   |
|   ‚úÖ    | –ú–∏–≥—Ä–∞—Ü–∏—è –∏ –Ω–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –ë–î       | `php artisan migrate --seed`      |
|   ‚úÖ    | –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ API     | `php artisan l5-swagger:generate` |
|   ‚úÖ    | –ó–∞–ø—É—Å–∫ development —Å–µ—Ä–≤–µ—Ä–∞     | `php artisan serve`               |
|   ‚úÖ    | –ó–∞–ø—É—Å–∫ –æ—á–µ—Ä–µ–¥–µ–π                | `php artisan queue:work`          |
|   ‚úÖ    | –ó–∞–ø—É—Å–∫ Websocket —Å–µ—Ä–≤–µ—Ä–∞       | `php artisan reverb:start`        |

---

## üîó –î–æ–ø–æ–ª–Ω–µ–Ω–∏—è

- **Swagger –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**: `/api/documentation`
- **–ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤**: `php artisan test`
- **–ü–æ–ª—É—á–µ–Ω–∏–µ –∫—É—Ä—Å–æ–≤ –≤–∞–ª—é—Ç (–Ω—É–∂–µ–Ω cron, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤ 01:00 –æ–±–Ω–æ–≤–ª—è–µ—Ç)** 

`php artisan currency:update-rates`


    currency:update-rates
    {date? : –î–∞—Ç–∞ –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫—É—Ä—Å–æ–≤ (Y-m-d). –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é - –≤—á–µ—Ä–∞—à–Ω–∏–π –¥–µ–Ω—å.}
    {--force : –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ, –∏–≥–Ω–æ—Ä–∏—Ä—É—è –≤–æ–∑–º–æ–∂–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è.}

- **–û–ø—Ä–æ—Å –ø–æ—Å—ã–ª–æ–∫ –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏—Ö —Å—Ç–∞—Ç—É—Å–æ–≤ –∏ —Å–æ–±—ã—Ç–∏–π –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è (–Ω—É–∂–µ–Ω cron, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç)** 

`php artisan tracking:poll-shipments`


    tracking:poll-shipments
    {--limit=100 : –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Å—ã–ª–æ–∫ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞ –æ–¥–∏–Ω –∑–∞–ø—É—Å–∫}
    {--status=* : –°—Ç–∞—Ç—É—Å—ã –ø–æ—Å—ã–ª–æ–∫ –¥–ª—è –æ–ø—Ä–æ—Å–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, --status=6 --status=7). –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: SENT, RECEIVED}
    {--force-refresh : –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ, –∏–≥–Ω–æ—Ä–∏—Ä—É—è –∫—ç—à}

–ö–æ–º–∞–Ω–¥–∞ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –≤ –æ—á–µ—Ä–µ–¥—å –æ–±—Ä–∞–±–æ—Ç–∫—É –ø–æ—Å—ã–ª–æ–∫. 

–î–ª—è —Ä–∞–±–æ—Ç—ã –Ω—É–∂–µ–Ω `php artisan queue:work`

---

## üîî –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

–î–ª—è —Ä–∞–±–æ—Ç—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –Ω—É–∂–µ–Ω `php artisan queue:work`

–î–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π `telegram` —É–∫–∞–∑–∞—Ç—å –≤ `.env` –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é `TELEGRAM_BOT_TOKEN=`

–î–ª—è —Ä–∞–±–æ—Ç—ã `webpush` —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –Ω—É–∂–Ω–æ —Ä–∞–∑—Ä–µ—à–∏—Ç—å —Å–∞–π—Ç—É –ø—Ä–∏—Å—ã–ª–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è, 
–¥–æ–±–∞–≤–∏—Ç—å –≤ `.env` –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ `WEBPUSH_PUBLIC_KEY=` –∏ `WEBPUSH_PRIVATE_KEY=`.

–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —ç—Ç–∏ –∫–ª—é—á–∏ –º–æ–∂–Ω–æ –∫–æ–º–∞–Ω–¥–æ–π `php artisan webpush:generate-keys`. 
–ü–æ—Å–ª–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∫–æ–º–∞–Ω–¥—ã, –æ–Ω–∞ –≤—ã–¥–∞—Å—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫–ª—é—á–∏.

---

## üîÑ –ú–æ–¥—É–ª—å –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –∏ Websockets

–î–ª—è —Ä–∞–±–æ—Ç—ã `Websockets` –Ω—É–∂–Ω–æ –≤–∫–ª—é—á–∏—Ç—å `php artisan reverb:start` –∏ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –≤ `.env` —Å–ª–µ–¥—É—é—â–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:

    BROADCAST_CONNECTION=reverb

    REVERB_APP_ID=
    REVERB_APP_KEY=
    REVERB_APP_SECRET=
    REVERB_HOST=
    REVERB_PORT=
    REVERB_SCHEME=
    
    VITE_REVERB_APP_KEY="${REVERB_APP_KEY}"
    VITE_REVERB_HOST="${REVERB_HOST}"
    VITE_REVERB_PORT="${REVERB_PORT}"
    VITE_REVERB_SCHEME="${REVERB_SCHEME}"

---

## üì¶ –ú–æ–¥—É–ª—å —Ç—Ä–∫–µ–Ω–∏–≥–∞ –¥–ª—è –ø–æ—Å—ã–ª–æ–∫ (–ü–æ—á—Ç–∞ –†–æ—Å—Å–∏–∏)

–î–ª—è —Ä–∞–±–æ—Ç—ã –Ω—É–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –≤ `.env` –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ

    RUSPOST_CLIENT_ID=
    RUSPOST_CLIENT_SECRET=

---

## üí≥ –ú–æ–¥—É–ª—å —ç–∫–≤–∞–π—Ä–∏–Ω–≥–∞

–î–ª—è —Ä–∞–±–æ—Ç—ã –Ω—É–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –≤ `.env` –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é `ACQUIRING_ENCRYPTION_KEY=`

---

## üîê SSO-–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

### –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞
**0.** –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã –≤ `/config/sso.php`

### –®–∞–≥ 1: –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞
**POST** `/api/auth/token-login`

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `provider` - –ø—Ä–æ–≤–∞–π–¥–µ—Ä –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- `token` - JWT —Ç–æ–∫–µ–Ω (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–æ–ª–µ `email`)

**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–ª –∑–¥–µ—Å—å:** https://token.dev/

#### –ü—Ä–∏–º–µ—Ä JWT —Ç–æ–∫–µ–Ω–∞
    eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImtpZCI6InRlc3QtcnNhIn0.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiYWRtaW4iOnRydWUsImlhdCI6MTc1NzA2MTc4NiwiZXhwIjoxNzk5MDY1Mzg2LCJlbWFpbCI6InRlc3RAbWFpbC5ydSIsImlzcyI6Imh0dHBzOi8vdG9rZW4uZGV2IiwiYXVkIjoiYXBpOi8vZGVmYXVsdCIsImp0aSI6IjEyMzEyMyJ9.hDeCWJVyS3gwXK3AYNSSkadEffDlSqu_fVyH-RQo4gFZI5IHew7NAeeL77Gtmsb1AhqJVAKwcyU3EG2RmxjKN6Sy-qja9T4fiZC4PMUghHsyp2hyJZqoYwVamfnOVXHEGpNt5KYO_ONcP-KebmK77ULmoCNUr0NCHPkLuNPOxFPlKNE-bmoC-eusEQWQU4b-33DkahzhfkOppdS25WjL-Zefe6Z3NBHK-m8LIz47BZ8Uzn8se3tYK3IAbCe1QbocgZjo699sdjC8lsVjVb5qaItMHLe0IPQin8PACC9TGOXjJzZd94cmJqFBnRTowCxBcUXFUBD73KzTbyJyS8pV6g


**Header:**

    {
        "typ": "JWT",
        "alg": "RS256",
        "kid": "test-rsa"
    }

**Payload:**

    {
        "sub": "1234567890",
        "name": "John Doe",
        "admin": true,
        "iat": 1757061786,
        "exp": 1799065386,
        "email": "test@mail.ru",
        "iss": "https://token.dev",
        "aud": "api://default",
        "jti": "123123"
    }

### –®–∞–≥ 2: –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–≤–µ—Ç–∞ —Å–µ—Ä–≤–µ—Ä–∞
- –ü–æ–ª—É—á–∞–µ–º —Ç–æ–∫–µ–Ω –∏–∑ –ø–æ–ª—è `access_token`
- –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–æ–∫–µ–Ω (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ Postman)
- –ò—Å–ø–æ–ª—å–∑—É–µ–º –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é: `Authorization: Bearer –≤–∞—à_—Ç–æ–∫–µ–Ω`

### –®–∞–≥ 3: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ API
- **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**: GET `/api/me`
- **–í—ã—Ö–æ–¥ –∏–∑ —Å–∏—Å—Ç–µ–º—ã**: GET `/api/logout`

---

## üîë –ù–∞—à–∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ API —Ç–æ–∫–µ–Ω—ã

- **–ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞**: POST `/api/auth/tokens`
- **–í—ã—Ö–æ–¥ –∏–∑ —Å–∏—Å—Ç–µ–º—ã**: GET `/api/auth/tokens/logout`
- –î–ª—è –≤—Ö–æ–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–µ–º `password` –∏ `email` —É–∫–∞–∑–∞–Ω–Ω—ã–π –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
- –û—Ç —Å–µ—Ä–≤–µ—Ä–∞ –ø–æ–ª—É—á–∞–µ–º `token`, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–Ω–æ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –∫–∞–∫:
    - query –ø–∞—Ä–∞–º–µ—Ç—Ä `api_key`
    - –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ `X-API-Key`

---

## üîó Redirect URLs –¥–ª—è OAuth

- **Google**: `/auth/google/callback`
- **Yandex**: `/auth/yandex/callback`
- **Vkontakte**: `/auth/vkontakte/callback`
- **MailRu**: `/auth/mailru/callback`

**–í—Å–µ —Å–µ–∫—Ä–µ—Ç—ã –≤ —Ñ–∞–π–ª–µ `.env`**
